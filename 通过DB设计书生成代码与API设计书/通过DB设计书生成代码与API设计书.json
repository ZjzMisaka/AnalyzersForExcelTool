{"name":"通过DB设计书生成代码与API设计书","code":"using ClosedXML.Excel;\nusing GlobalObjects;\nusing System;\nusing System.Collections.Concurrent;\nusing System.Collections.Generic;\n\nnamespace AnalyzeCode\n{\n    // DatabaseType Postgresql|SqlServer|MySQL|Oracle\n    // TableIDPos\n    // TableNamePos\n    // StartRowNum\n    // ColIDCol\n    // ColNameCol\n    // TypeCol\n    // DigitsCheckCol\n    // DecimalCheckCol\n    // NullCheckCol\n    \n    public static class Converter\n    {\n        public enum DicType { DesignBookType, DatabaseType };\n        \n        public static Dictionary<string, string> postgresqlDic = new Dictionary<string, string>() \n        {\n            {\"date\", \"LocalDate\"},\n            {\"time\", \"LocalTime\"},\n            {\"timestamp without timezone\", \"LocalDateTime\"},\n            {\"timestamp with timezone\", \"OffsetDateTime\"},\n            {\"varchar\", \"String\"},\n            {\"text\", \"String\"},\n            {\"int2\", \"Integer\"},\n            {\"int4\", \"Integer\"},\n            {\"int8\", \"Long\"},\n            {\"float4\", \"Float\"},\n            {\"float8\", \"Double\"},\n            {\"numeric\", \"BigDecimal\"},\n            {\"bool\", \"Boolean\"},\n        };\n        \n        public static Dictionary<string, string> sqlServerDic = new Dictionary<string, string>() \n        {\n            {\"binary\", \"byte[]\"},\n            {\"bit\", \"long\"},\n            {\"char\", \"long\"},\n            {\"date\", \"long\"},\n            {\"datetime\", \"Timestamp\"},\n            {\"decimal\", \"long\"},\n            {\"bigint\", \"BigDecimal\"},\n            {\"float\", \"double\"},\n            {\"image\", \"byte[]\"},\n            {\"int\", \"int\"},\n            {\"money\", \"BigDecimal\"},\n            {\"nchar\", \"String\"},\n            {\"ntext\", \"String\"},\n            {\"numeric\", \"BigDecimal\"},\n            {\"nvarchar\", \"long\"},\n            {\"real\", \"float\"},\n            {\"smalldatetime\", \"Timestamp\"},\n            {\"smallint\", \"short\"},\n            {\"smallmoney\", \"BigDecimal\"},\n            {\"text\", \"String\"},\n            {\"time\", \"Time\"},\n            {\"timestamp\", \"byte[]\"},\n            {\"tinyint\", \"short\"},\n            {\"udt\", \"byte[]\"},\n            {\"uniqueidentifier\", \"    String\"},\n            {\"varbinary\", \"byte[]\"},\n            {\"varchar\", \"String\"},\n            {\"xml\", \"String\"},\n            {\"sqlvariant\", \"Object\"},\n            {\"geometry\", \"byte[]\"},\n            {\"geography\", \"byte[]\"}\n        };\n        \n        public static Dictionary<string, string> mySqlDic = new Dictionary<string, string>() \n        {\n            {\"char\", \"String\"},\n            {\"varchar\", \"String\"},\n            {\"longvarchar\", \"String\"},\n            {\"numeric\", \"BigDecimal\"},\n            {\"decimal\", \"BigDecimal\"},\n            {\"bit\", \"boolean\"},\n            {\"tinyint\", \"byte\"},\n            {\"smallint\", \"short\"},\n            {\"integer\", \"int\"},\n            {\"bigint\", \"long\"},\n            {\"real\", \"float\"},\n            {\"float\", \"double\"},\n            {\"double\", \"double\"},\n            {\"binary\", \"byte[]\"},\n            {\"varbinary\", \"byte[]\"},\n            {\"longvarbinary\", \"byte[]\"},\n            {\"date\", \"Date\"},\n            {\"time\", \"String\"},\n            {\"timestamp\", \"Timestamp\"}\n        };\n        \n        public static Dictionary<string, string> oracleDic = new Dictionary<string, string>() \n        {\n            {\"char\", \"String\"},\n            {\"varchar2\", \"String\"},\n            {\"long\", \"String\"},\n            {\"number\", \"BigDecimal\"},\n            {\"number(1)\", \"boolean\"},\n            {\"number(2)\", \"Byte\"},\n            {\"number(3~4)\", \"Short\"},\n            {\"number(5~9)\", \"Integer\"},\n            {\"number(10~18)\", \"long\"},\n            {\"number(19~38)\", \"BigDecimal\"},\n            {\"date\", \"Timestamp\"},\n            {\"timestamp\", \"Timestamp\"},\n            {\"raw\", \"byte[]\"},\n            {\"longraw\", \"byte[]\"}\n        };\n    }\n    \n    public class Table\n    {\n        public string tableID;\n        public string tableName;\n        public bool hasPrimaryKey;\n        \n        public List<Column> columnList;\n        \n        public Table(string tableID, string tableName, List<Column> columnList)\n        {\n            this.tableID = tableID;\n            this.tableName = tableName;\n            this.columnList = columnList;\n            this.hasPrimaryKey = false;\n            foreach(Column column in columnList)\n            {\n                if (column.isPrimaryKey)\n                {\n                    this.hasPrimaryKey = true;\n                    break;\n                }\n            }\n        }\n    }\n    \n    public class Column\n    {\n        public string colID;\n        public string colName;\n        public string type;\n        public int digitsCheck;\n        public int decimalCheck;\n        public bool notNull;\n        public bool isPrimaryKey;\n        \n        public Column(string colID, string colName, string type, int digitsCheck, int decimalCheck, bool notNull = false, bool isPrimaryKey = false)\n        {\n            this.colID = colID;\n            this.colName = colName;\n            this.type = type;\n            this.digitsCheck = digitsCheck;\n            this.decimalCheck = decimalCheck;\n            this.notNull = notNull;\n            this.isPrimaryKey = isPrimaryKey;\n        }\n    }\n    \n    public class Analyze\n    {\n        /// <summary>\n        /// 在所有分析前调用\n        /// </summary>\n        /// <param name=\"param\">传入的参数</param>\n        /// <param name=\"globalObject\">全局存在, 可以保存需要在其他调用时使用的数据, 如当前行号等</param>\n        /// <param name=\"allFilePathList\">将会分析的所有文件路径列表</param>\n        /// <param name=\"isExecuteInSequence\">是否顺序执行</param>\n        public void RunBeforeAnalyzeSheet(Param param, ref Object globalObject, List<string> allFilePathList, bool isExecuteInSequence)\n        {\n            Output.IsSaveDefaultWorkBook = false;\n            globalObject = new List<Table>();\n        }\n\n        /// <summary>\n        /// 分析一个sheet\n        /// </summary>\n        /// <param name=\"param\">传入的参数</param>\n        /// <param name=\"sheet\">被分析的sheet</param>\n        /// <param name=\"filePath\">文件路径</param>\n        /// <param name=\"globalObject\">全局存在, 可以保存需要在其他调用时使用的数据, 如当前行号等</param>\n        /// <param name=\"isExecuteInSequence\">是否顺序执行</param>\n        /// <param name=\"invokeCount\">此分析函数被调用的次数</param>\n        public void AnalyzeSheet(Param param, IXLWorksheet sheet, string filePath, ref Object globalObject, bool isExecuteInSequence, int invokeCount)\n        {\n            Logger.Info(\"Analysing Sheet: \" + sheet.Name + \"...\");\n            \n            string tableIDPos = param.GetOne(\"TableIDPos\");\n            string tableNamePos = param.GetOne(\"TableNamePos\");\n            int currentRowNum = int.Parse(param.GetOne(\"StartRowNum\"));\n            string colIDCol = param.GetOne(\"ColIDCol\");\n            string colNameCol = param.GetOne(\"ColNameCol\");\n            string typeCol = param.GetOne(\"TypeCol\");\n            string digitsCheckCol = param.GetOne(\"DigitsCheckCol\");\n            string decimalCheckCol = param.GetOne(\"DecimalCheckCol\");\n            string nullCheckCol = param.GetOne(\"NullCheckCol\");\n            string isPrimaryKeyCol = param.GetOne(\"PrimaryKeyCol\");\n            string tableID = sheet.Cell(tableIDPos).CachedValue.ToString();\n            \n            string tableName = string.IsNullOrWhiteSpace(tableNamePos) ? \"\" :  sheet.Cell(tableNamePos).CachedValue.ToString();\n            \n            \n            List<Column> columnList = new List<Column>();\n            while (CellNotBlank(sheet.Cell(colIDCol + currentRowNum)))\n            {\n                string colID = sheet.Cell(colIDCol + currentRowNum).CachedValue.ToString();\n                string colName = string.IsNullOrWhiteSpace(colNameCol) ? \"\" :  sheet.Cell(colNameCol + currentRowNum).CachedValue.ToString();\n                string type = sheet.Cell(typeCol + currentRowNum).CachedValue.ToString();\n                int digitsCheck = string.IsNullOrWhiteSpace(digitsCheckCol) || string.IsNullOrWhiteSpace(sheet.Cell(digitsCheckCol + currentRowNum).CachedValue.ToString()) ? -1 :  int.Parse(sheet.Cell(digitsCheckCol + currentRowNum).CachedValue.ToString());\n                int decimalCheck = string.IsNullOrWhiteSpace(decimalCheckCol) || string.IsNullOrWhiteSpace(sheet.Cell(decimalCheckCol + currentRowNum).CachedValue.ToString()) ? -1 :  int.Parse(sheet.Cell(decimalCheckCol + currentRowNum).CachedValue.ToString());\n                bool notNull = CheckIfStringIsTrue(sheet.Cell(nullCheckCol + currentRowNum).CachedValue.ToString(), new List<string>(){\"not null\"});\n                bool isPrimaryKey = CellNotBlank(sheet.Cell(isPrimaryKeyCol + currentRowNum));\n                \n                columnList.Add(new Column(colID, colName, type, digitsCheck, decimalCheck, notNull, isPrimaryKey));\n                \n                ++currentRowNum;\n            }\n            Table table = new Table(tableID, tableName, columnList);\n            \n            ((List<Table>)globalObject).Add(table);\n        }\n\n        /// <summary>\n        /// 在所有输出前调用\n        /// </summary>\n        /// <param name=\"param\">传入的参数</param>\n        /// <param name=\"workbook\">用于输出的excel文件</param>\n        /// <param name=\"globalObject\">全局存在, 可以保存需要在其他调用时使用的数据, 如当前行号等</param>\n        /// <param name=\"allFilePathList\">分析的所有文件路径列表</param>\n        /// <param name=\"isExecuteInSequence\">是否顺序执行</param>\n        public void RunBeforeSetResult(Param param, XLWorkbook workbook, ref Object globalObject, List<string> allFilePathList, bool isExecuteInSequence)\n        {\n            \n        }\n\n        /// <summary>\n        /// 根据分析结果输出到excel中\n        /// </summary>\n        /// <param name=\"param\">传入的参数</param>\n        /// <param name=\"workbook\">用于输出的excel文件</param>\n        /// <param name=\"filePath\">文件路径</param>\n        /// <param name=\"globalObject\">全局存在, 可以保存需要在其他调用时使用的数据, 如当前行号等</param>\n        /// <param name=\"isExecuteInSequence\">是否顺序执行</param>\n        /// <param name=\"invokeCount\">此输出函数被调用的次数</param>\n        /// <param name=\"totalCount\">总共需要调用的输出函数的次数</param>\n        public void SetResult(Param param, XLWorkbook workbook, string filePath, ref Object globalObject, bool isExecuteInSequence, int invokeCount, int totalCount)\n        {\n            List<Table> tableList = (List<Table>)globalObject;\n            foreach (Table table in tableList)\n            {\n                Logger.Info(\"Making entity: \" + table.tableID + \", \" + table.tableName + \"...\");\n                MakeEntityFile(table, param, Output.OutputPath);\n                Logger.Info(\"Making mapper: \" + table.tableID + \", \" + table.tableName + \"...\");\n                MakeMapperFile(table, param, Output.OutputPath);\n                // ConvertMapperIntoExcel\n            }\n        }\n\n        /// <summary>\n        /// 所有调用结束后调用\n        /// </summary>\n        /// <param name=\"param\">传入的参数</param>\n        /// <param name=\"workbook\">用于输出的excel文件</param>\n        /// <param name=\"globalObject\">全局存在, 可以保存需要在其他调用时使用的数据, 如当前行号等</param>\n        /// <param name=\"allFilePathList\">分析的所有文件路径列表</param>\n        /// <param name=\"isExecuteInSequence\">是否顺序执行</param>\n        public void RunEnd(Param param, XLWorkbook workbook, ref Object globalObject, List<string> allFilePathList, bool isExecuteInSequence)\n        {\n            \n        }\n        \n        public bool CellNotBlank(IXLCell cell)\n        {\n            if (string.IsNullOrWhiteSpace(cell.CachedValue.ToString()))\n            {\n                return false;\n            }\n        \n            return true;\n        }\n        \n        public bool CheckIfStringIsTrue(string str, List<string> extra = null)\n        {\n            str = str.ToLower().Trim();\n            if (str == \"true\" || str == \"〇\" || str == \"○\" || str == \"1\")\n            {\n                return true;\n            }\n            if (extra != null)\n            {\n                foreach (string extraStr in extra)\n                {\n                    if (str == extraStr)\n                    {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        }\n        \n        public string UnderScoreCaseToCamelCase(string str, bool isUpperCamelCase = false)\n        {\n            str = str.ToLower().Trim();\n            while (str.Contains(\"_\"))\n            {\n                int index = str.IndexOf('_');\n                string upper = str[index + 1].ToString().ToUpper();\n                str = str.Remove(index, 2);\n                str = str.Insert(index, upper);\n            }\n            \n            if (isUpperCamelCase)\n            {\n                string upper = str[0].ToString().ToUpper();\n                str = str.Remove(0, 1);\n                str = str.Insert(0, upper);\n            }\n            \n            return str;\n        }\n        \n        long LongRandom(long min, long max, Random rand) \n        {\n            //Working with ulong so that modulo works correctly with values > long.MaxValue\n            ulong uRange = (ulong)(max - min);\n            \n            //Prevent a modolo bias; see https://stackoverflow.com/a/10984975/238419\n            //for more information.\n            //In the worst case, the expected number of calls is 2 (though usually it's\n            //much closer to 1) so this loop doesn't really hurt performance at all.\n            ulong ulongRand;\n            do\n            {\n                byte[] buf = new byte[8];\n                rand.NextBytes(buf);\n                ulongRand = (ulong)BitConverter.ToInt64(buf, 0);\n            } while (ulongRand > ulong.MaxValue - ((ulong.MaxValue % uRange) + 1) % uRange);\n            \n            return (long)(ulongRand % uRange) + min;\n        }\n        \n        public string MakeLevel(int level)\n        {\n            string res = \"\";\n            for (int i = 0; i < level; ++i)\n            {\n                res += \"    \";\n            }\n            return res;\n        }\n        \n        public Dictionary<string, string> GetConvertDic(Param param, Converter.DicType dicType)\n        {\n            Dictionary<string, string> convertDic;\n            string key;\n            if (dicType == Converter.DicType.DatabaseType)\n            {\n                key = \"DatabaseType\";\n            }\n            else\n            {\n                key = \"DesignBookType\";\n            }\n            if (param.GetOne(key) == \"Postgresql\")\n            {\n                convertDic = Converter.postgresqlDic;\n            }\n            else if (param.GetOne(key) == \"SqlServer\")\n            {\n                convertDic = Converter.sqlServerDic;\n            }\n            else if (param.GetOne(key) == \"MySQL\")\n            {\n                convertDic = Converter.mySqlDic;\n            }\n            else if (param.GetOne(key) == \"Oracle\")\n            {\n                convertDic = Converter.oracleDic;\n            }\n            else\n            {\n                convertDic = Converter.oracleDic;\n            }\n            \n            return convertDic;\n        }\n        \n        public string GetJavaType(Dictionary<string, string> convertDic, Column column)\n        {\n            string type = column.type.ToLower();\n            bool done = false;\n            foreach (string key in convertDic.Keys)\n            {\n                string keyType = key;\n                if (keyType.Contains(\"~\"))\n                {\n                    string left = keyType.Substring(0, keyType.IndexOf('(') - 1);\n                    string right = keyType.Substring(keyType.IndexOf('(')).Replace(\"(\", \"\").Replace(\")\", \"\");\n                    int from = int.Parse(right.Split('~')[0]);\n                    int to = int.Parse(right.Split('~')[1]);\n                    for (int i = from; i < to; ++i)\n                    {\n                        string keyTypeTemp = left + \"(\" + i + \")\";\n                        if (type == keyTypeTemp)\n                        {\n                            type = convertDic[keyTypeTemp];\n                            done = true;\n                            break;\n                        }\n                    }\n                }\n                else\n                {\n                    if (type == keyType)\n                    {\n                        type = convertDic[keyType];\n                        done = true;\n                        break;\n                    }\n                }\n            }\n            if (!done)\n            {\n                foreach (string key in convertDic.Keys)\n                {\n                    string keyType = key;\n                    if (type.StartsWith(keyType))\n                    {\n                        type = convertDic[keyType];\n                        break;\n                    }\n                }\n            }\n            \n            return type;\n        }\n        \n        public string GetNowTimestampStr(Param param)\n        {\n            return \"CURRENT_TIMESTAMP\";\n        }\n        \n        \n        /** MAKE ENTITY START **************************************************************************************************/\n        \n        public void MakeDocComment(List<string> strList, List<string> commentList, int level)\n        {\n            strList.Add(MakeLevel(level) + \"/**\");\n            foreach(string comment in commentList)\n            {\n                strList.Add(MakeLevel(level) + \" * \" + comment);\n            }\n            strList.Add(MakeLevel(level) + \" */\");\n        }\n        \n        public void MakeAnnotation(List<string> strList, Column column, int level, List<string> importList, Param param)\n        {\n            Dictionary<string, string> dic = GetConvertDic(param, Converter.DicType.DesignBookType);\n        \n            if (column.notNull)\n            {\n                if (GetJavaType(dic, column) == \"String\")\n                {\n                    if (!importList.Contains(\"import javax.validation.constraints.NotBlank;\"))\n                    {\n                        importList.Add(\"import javax.validation.constraints.NotBlank;\");\n                    }\n                    strList.Add(MakeLevel(level) + \"@NotBlank\");\n                }\n                else\n                {\n                    if (!importList.Contains(\"import javax.validation.constraints.NotEmpty;\"))\n                    {\n                        importList.Add(\"import javax.validation.constraints.NotEmpty;\");\n                    }\n                    strList.Add(MakeLevel(level) + \"@NotEmpty\");\n                }\n            }\n            if (column.digitsCheck >= 0)\n            {\n                if (!importList.Contains(\"import org.hibernate.validator.constraints.Length;\"))\n                {\n                    importList.Add(\"import org.hibernate.validator.constraints.Length;\");\n                }\n                strList.Add(MakeLevel(level) + \"@Length(min = 0, max = \" + column.digitsCheck + \")\");\n            }\n            if (column.decimalCheck >= 0)\n            {\n                if (!importList.Contains(\"import javax.validation.constraints.Digits;\"))\n                {\n                    importList.Add(\"import javax.validation.constraints.Digits;\");\n                }\n                strList.Add(MakeLevel(level) + \"@Digits(integer = \" + (column.digitsCheck - (column.decimalCheck == 0 ? 0 : 1) - column.decimalCheck) + \", fraction = \" + column.decimalCheck + \")\");\n            }\n        }\n        \n        public void MakeProperty(List<string> strList, Column column, int level, Param param, List<string> importList)\n        {\n            Dictionary<string, string> convertDic = GetConvertDic(param, Converter.DicType.DesignBookType);\n        \n            string type = GetJavaType(convertDic, column);\n            \n            CheckAndAddImportList(type, importList);\n            \n            strList.Add(MakeLevel(level) + \"private \" + type + \" \" + UnderScoreCaseToCamelCase(column.colID) + \";\");\n        }\n        \n        public void CheckAndAddImportList(string type, List<string> importList)\n        {\n            if (type == \"LocalDateTime\")\n            {\n                string str = \"import java.time.LocalDateTime;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n            else if (type == \"OffsetDateTime\")\n            {\n                string str = \"import java.time.OffsetDateTime;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n            else if (type == \"LocalDate\")\n            {\n                string str = \"import java.time.LocalDate;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n            else if (type == \"LocalTime\")\n            {\n                string str = \"import java.time.LocalTime;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n            else if (type == \"BigDecimal\")\n            {\n                string str = \"import java.math.BigDecimal;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n            else if (type == \"Timestamp\")\n            {\n                string str = \"import java.sql.Timestamp;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n            else if (type == \"Time\")\n            {\n                string str = \"import java.sql.Time;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n            else if (type == \"Date\")\n            {\n                string str = \"import java.sql.Date;\";\n                if (!importList.Contains(str))\n                {\n                    importList.Add(str);\n                }\n            }\n        }\n        \n        public void MakeEntityFile(Table table, Param param, string path)\n        {\n            List<string> body = new List<string>();\n            List<string> importList = new List<string>() { \"\", \"import lombok.Data;\", \"import java.io.Serializable;\" };\n            MakeEntityPackage(body, param);\n            body.Add(\"@Data\");\n            MakeEntityClassBody(table, body, param, importList);\n            \n            importList.Add(\"\");\n            body.InsertRange (1, importList);\n            \n            string outputPath = System.IO.Path.Combine(path, UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity.java\");\n            Logger.Info(\"Write into: \" + outputPath + \"...\");\n            System.IO.File.WriteAllLines(outputPath, body);\n            Logger.Info(\"OK\");\n        }\n        \n        public void MakeEntityPackage(List<string> body, Param param)\n        {\n            body.Add(\"package \" + param.GetOne(\"EntityPackage\") + \";\");\n        }\n        \n        public void MakeEntityClassBody(Table table, List<string> body, Param param, List<string> importList)\n        {\n            body.Add(\"public class \" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\" + \" implements Serializable {\");\n            body.Add(\"    private static final long serialVersionUID = \" + LongRandom(long.MinValue, long.MaxValue, new Random(Guid.NewGuid().GetHashCode())) + \"L;\");\n            \n            foreach (Column column in table.columnList)\n            {\n                body.Add(\"\");\n                MakeDocComment(body, new List<string>() {column.colName}, 1);\n                if (param.GetOne(\"EnableValidate\") == \"Yes\")\n                {\n                    MakeAnnotation(body, column, 1, importList, param);\n                }\n                MakeProperty(body, column, 1, param, importList);\n            }\n            \n            body.Add(\"}\");\n        }\n        \n        \n        \n        \n        \n        /** MAKE MAPPER START **************************************************************************************************/\n        \n        public string MakeTestHead(Param param, Dictionary<string, string> convertDic, Column column, int level)\n        {\n            string head = MakeLevel(level) + \"<if test=\\\"entity.\" + UnderScoreCaseToCamelCase(column.colID) + \" != null\";\n            // 当向Oracle中传\"\"时Oracle会自动将其转换为null, 而Potgresql, SqlServer, MySql会保持为空字符串. \n            // 因此对于一个NotNull字段, Postgresql, MySql和SqlServer中允许传\"\"但Oracle不允许\n            if (param.GetOne(\"DatabaseType\") == \"Oracle\" && column.notNull && GetJavaType(convertDic, column) == \"String\")\n            {\n                head += \" and entity.\" + UnderScoreCaseToCamelCase(column.colID) + \" !=''\";\n            }\n            head += \"\\\">\";\n            \n            return head;\n        }\n        \n        public string MakeLeftEqualRight(Column column, int level, string str, bool addBack = false)\n        {\n            string res = MakeLevel(level) + (!addBack ? str : \"\") + column.colID.ToUpper() + \" = #{entity.\" + UnderScoreCaseToCamelCase(column.colID) + \"}\" + (addBack ? str : \"\");\n            \n            return res;\n        }\n        \n        public void MakeOrder(List<string> body, int startlevel)\n        {\n            body.Add(MakeLevel(startlevel) + \"<if test=\\\"orderCol != null and orderCol !=''\\\">\");\n            body.Add(MakeLevel(startlevel + 1) + \"ORDER BY ${orderCol}\");\n            body.Add(MakeLevel(startlevel + 1) + \"<if test=\\\"order != null and order !=''\\\">\");\n            body.Add(MakeLevel(startlevel + 2) + \"${order}\");\n            body.Add(MakeLevel(startlevel + 1) + \"</if>\");\n            body.Add(MakeLevel(startlevel) + \"</if>\");\n        }\n        \n        public void MakeMapperFile(Table table, Param param, string path)\n        {\n            Dictionary<string, string> convertDic = GetConvertDic(param, Converter.DicType.DatabaseType);\n        \n            List<string> body = new List<string>();\n            MakeXmlHeader(body, param);\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \"の\") + \"エンティティ -->\");\n            MakeResultMap(body, param, table);\n            if (!string.IsNullOrWhiteSpace(param.GetOne(\"UpdateTimeId\")))\n            {\n                body.Add(\"\");\n                body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \" \") + \"排他チェック処理 -->\");\n                MakeExclusiveCheck(body, param, table, convertDic);\n            }\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \" \") + \"件数の検索 *entityパラメータは入力しなくてもよい -->\");\n            MakeSelectCount(body, param, table, convertDic);\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \" \") + \"全検索 -->\");\n            MakeSelectAll(body, param, table);\n            if (table.hasPrimaryKey)\n            {\n                body.Add(\"\");\n                body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \" \") + \"主キーで検索 -->\");\n                MakeSelectByKey(body, param, table, convertDic);\n            }\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \"の\") + \"条件検索 -->\");\n            MakeSelect(body, param, table, convertDic);\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \"の\") + \"条件検索 ソートあり -->\");\n            MakeSelectWithOrder(body, param, table, convertDic);\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \"の\") + \"作成 -->\");\n            MakeInsert(body, param, table, convertDic);\n            if (table.hasPrimaryKey)\n            {\n                body.Add(\"\");\n                body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \"の\") + \"削除 -->\");\n                MakeDeleteByKey(body, param, table, convertDic);\n            }\n            if (table.hasPrimaryKey)\n            {\n                body.Add(\"\");\n                body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \"の\") + \"更新 -->\");\n                MakeUpdateByKey(body, param, table, convertDic);\n            }\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \"の\") + \"ページング検索 -->\");\n            MakeSelectPage(body, param, table, convertDic);\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \" \") + \"複数のレコードを追加 -->\");\n            MakeInsertMultipleByKey(body, param, table, convertDic);\n            body.Add(\"\");\n            body.Add(MakeLevel(1) + \"<!-- \" + table.tableName + (string.IsNullOrWhiteSpace(table.tableName) ? \"\" : \" \") + \"複数のレコードを削除 -->\");\n            MakeDeleteMultipleByKey(body, param, table, convertDic);\n            body.Add(\"</mapper>\");\n            \n            string outputPath = System.IO.Path.Combine(path, UnderScoreCaseToCamelCase(table.tableID, true) + \"Mapper.xml\");\n            Logger.Info(\"Write into: \" + outputPath + \"...\");\n            System.IO.File.WriteAllLines(outputPath, body);\n            Logger.Info(\"OK\");\n        }\n        \n        public void MakeXmlHeader (List<string> body, Param param)\n        {\n            body.Add(\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\");\n            body.Add(\"<!DOCTYPE mapper PUBLIC \\\"-//mybatis.org//DTD Mapper 3.0//EN\\\" \\\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\\\" >\");\n            body.Add(\"<mapper namespace=\\\"\" + param.GetOne(\"MapperPackage\") + \"\\\">\");\n        }\n        \n        public void MakeResultMap(List<string> body, Param param, Table table)\n        {\n            body.Add(MakeLevel(1) + \"<resultMap id=\\\"ResultMap\\\" type=\\\"\" + param.GetOne(\"EntityPackage\") + \".\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\\\">\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(2) + \"<result column=\\\"\" + column.colID.ToUpper() + \"\\\" property=\\\"\" + UnderScoreCaseToCamelCase(column.colID) + \"\\\" />\");\n            }\n            body.Add(MakeLevel(1) + \"</resultMap>\");\n        }\n        \n        public void MakeExclusiveCheck(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<select id=\\\"exclusiveCheck\\\" resultType=\\\"java.lang.Integer\\\">\");\n            \n            body.Add(MakeLevel(2) + \"SELECT\");\n            body.Add(MakeLevel(2) + \"COUNT(1)\");\n            body.Add(MakeLevel(2) + \"FROM\");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"WHERE\");\n            if (table.hasPrimaryKey)\n            {\n                body.Add(MakeLevel(2) + \"1 = 1\");\n                Column updateCol = null;\n                foreach (Column column in table.columnList)\n                {\n                    if (column.colID.ToUpper() == param.GetOne(\"UpdateTimeId\").ToUpper())\n                    {\n                        updateCol = column;\n                    }\n                    if (column.isPrimaryKey)\n                    {\n                        body.Add(MakeTestHead(param, convertDic, column, 2));\n                        body.Add(MakeLeftEqualRight(column, 3, \"AND \"));\n                        body.Add(MakeLevel(2) + \"</if>\");\n                    }\n                }\n                \n                if (updateCol != null)\n                {\n                    body.Add(MakeTestHead(param, convertDic, updateCol, 2));\n                    body.Add(MakeLeftEqualRight(updateCol, 3, \"AND \"));\n                    body.Add(MakeLevel(2) + \"</if>\");\n                }\n                else\n                {\n                    body.Add(MakeLevel(2) + \"<!-- TODO Can't find update time column: \" + param.GetOne(\"UpdateTimeId\").ToUpper() + \" -->\");\n                    Logger.Warn(\"Can't find update time column: \" + param.GetOne(\"UpdateTimeId\").ToUpper());\n                    Logger.Warn(\"Search <!-- TODO Can't find update time column: \" + param.GetOne(\"UpdateTimeId\").ToUpper() + \" --> to fix it\");\n                }\n            }\n            \n            body.Add(MakeLevel(1) + \"</select>\");\n        }\n        \n        public void MakeSelectCount(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<select id=\\\"select\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Count\\\" parameterType=\\\"\" + param.GetOne(\"EntityPackage\") + \".\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\\\" resultType=\\\"java.lang.Integer\\\">\");\n            body.Add(MakeLevel(2) + \"SELECT\");\n            body.Add(MakeLevel(2) + \"COUNT(*)\");\n            body.Add(MakeLevel(2) + \"FROM \");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"<if test=\\\"entity != null\\\">\");\n            body.Add(MakeLevel(3) + \"WHERE\");\n            body.Add(MakeLevel(3) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeTestHead(param, convertDic, column, 3));\n                body.Add(MakeLeftEqualRight(column, 4, \"AND \"));\n                body.Add(MakeLevel(3) + \"</if>\");\n            }\n            body.Add(MakeLevel(2) + \"</if>\");\n            body.Add(MakeLevel(1) + \"</select>\");\n        }\n        \n        public void MakeSelectAll(List<string> body, Param param, Table table)\n        {\n            body.Add(MakeLevel(1) + \"<select id=\\\"selectAll\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"\\\" resultMap=\\\"ResultMap\\\">\");\n            body.Add(MakeLevel(2) + \"SELECT\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(2) + column.colID.ToUpper() + \",\");\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \"FROM \");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            MakeOrder(body, 2);\n            body.Add(MakeLevel(1) + \"</select>\");\n        }\n        \n        public void MakeSelectByKey(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<select id=\\\"select\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"ByKey\\\" parameterType=\\\"\" + param.GetOne(\"EntityPackage\") + \".\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\\\" resultMap=\\\"ResultMap\\\">\");\n            body.Add(MakeLevel(2) + \"SELECT\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(2) + column.colID.ToUpper() + \",\");\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \"FROM \");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"WHERE\");\n            body.Add(MakeLevel(2) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                if (column.isPrimaryKey)\n                {\n                    body.Add(MakeTestHead(param, convertDic, column, 2));\n                    body.Add(MakeLeftEqualRight(column, 3, \"AND \"));\n                    body.Add(MakeLevel(2) + \"</if>\");\n                }\n            }\n            body.Add(MakeLevel(1) + \"</select>\");\n        }\n        \n        public void MakeSelect(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<select id=\\\"select\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"\\\" parameterType=\\\"\" + param.GetOne(\"EntityPackage\") + \".\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\\\" resultMap=\\\"ResultMap\\\">\");\n            body.Add(MakeLevel(2) + \"SELECT\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(2) + column.colID.ToUpper() + \",\");\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \"FROM \");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"WHERE\");\n            body.Add(MakeLevel(2) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeTestHead(param, convertDic, column, 2));\n                body.Add(MakeLeftEqualRight(column, 3, \"AND \"));\n                body.Add(MakeLevel(2) + \"</if>\");\n            }\n            body.Add(MakeLevel(1) + \"</select>\");\n        }\n        \n        public void MakeSelectWithOrder(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<select id=\\\"select\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"WithOrder\\\" resultMap=\\\"ResultMap\\\">\");\n            body.Add(MakeLevel(2) + \"SELECT\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(2) + column.colID.ToUpper() + \",\");\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \"FROM \");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"WHERE\");\n            body.Add(MakeLevel(2) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeTestHead(param, convertDic, column, 2));\n                body.Add(MakeLeftEqualRight(column, 3, \"AND \"));\n                body.Add(MakeLevel(2) + \"</if>\");\n            }\n            MakeOrder(body, 2);\n            body.Add(MakeLevel(1) + \"</select>\");\n        }\n        \n        public void MakeInsert(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<insert id=\\\"insert\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"\\\" parameterType=\\\"\" + param.GetOne(\"EntityPackage\") + \".\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\\\">\");\n\n            body.Add(MakeLevel(2) + \"INSERT INTO\");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper() + \" (\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(3) + column.colID.ToUpper() + \",\");\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \") VALUES (\");\n            foreach (Column column in table.columnList)\n            {\n                if (column.colID.ToUpper() == param.GetOne(\"UpdateTimeId\").ToUpper() || column.colID.ToUpper() == param.GetOne(\"CreateTimeId\").ToUpper())\n                {\n                    body.Add(MakeLevel(3) + GetNowTimestampStr(param) + \",\");\n                }\n                else\n                {\n                    body.Add(MakeLevel(3) + \"#{entity.\" + UnderScoreCaseToCamelCase(column.colID) + \"},\");\n                }\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \")\");\n            body.Add(MakeLevel(1) + \"</insert>\");\n        }\n        \n        public void MakeDeleteByKey(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<delete id=\\\"delete\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"ByKey\\\" parameterType=\\\"\" + param.GetOne(\"EntityPackage\") + \".\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\\\">\");\n\n            body.Add(MakeLevel(2) + \"DELETE FROM\");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"WHERE\");\n            body.Add(MakeLevel(2) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                if (column.isPrimaryKey)\n                {\n                    body.Add(MakeTestHead(param, convertDic, column, 2));\n                    body.Add(MakeLeftEqualRight(column, 3, \"AND \"));\n                    body.Add(MakeLevel(2) + \"</if>\");\n                }\n            }\n            body.Add(MakeLevel(1) + \"</delete>\");\n        }\n        \n        public void MakeUpdateByKey(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<update id=\\\"update\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"ByKey\\\" parameterType=\\\"\" + param.GetOne(\"EntityPackage\") + \".\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Entity\\\">\");\n\n            body.Add(MakeLevel(2) + \"UPDATE \" + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"<set>\");\n            foreach (Column column in table.columnList)\n            {\n                if (!column.isPrimaryKey)\n                {\n                    body.Add(MakeTestHead(param, convertDic, column, 3));\n                    if (column.colID.ToUpper() == param.GetOne(\"UpdateTimeId\").ToUpper())\n                    {\n                        body.Add(MakeLevel(4) + column.colID.ToUpper() + \" = \" + GetNowTimestampStr(param) + \", \");\n                    }\n                    else\n                    {\n                        body.Add(MakeLeftEqualRight(column, 4, \",\", true));\n                    }\n                    body.Add(MakeLevel(3) + \"</if>\");\n                }\n            }\n            body.Add(MakeLevel(2) + \"</set>\");\n            body.Add(MakeLevel(2) + \"WHERE\");\n            body.Add(MakeLevel(2) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                if (column.isPrimaryKey)\n                {\n                    body.Add(MakeTestHead(param, convertDic, column, 2));\n                    body.Add(MakeLeftEqualRight(column, 3, \"AND \"));\n                    body.Add(MakeLevel(2) + \"</if>\");\n                }\n            }\n            \n            body.Add(MakeLevel(1) + \"</update>\");\n        }\n        \n        public void MakeSelectPage(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<select id=\\\"select\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"Page\\\" resultMap=\\\"ResultMap\\\">\");\n            body.Add(MakeLevel(2) + \"SELECT\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(2) + column.colID.ToUpper() + \",\");\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \"FROM \");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"<if test=\\\"entity != null\\\">\");\n            body.Add(MakeLevel(3) + \"WHERE\");\n            body.Add(MakeLevel(3) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeTestHead(param, convertDic, column, 3));\n                body.Add(MakeLeftEqualRight(column, 4, \"AND \"));\n                body.Add(MakeLevel(3) + \"</if>\");\n            }\n            body.Add(MakeLevel(2) + \"</if>\");\n            MakeOrder(body, 2);\n            body.Add(MakeLevel(2) + \"LIMIT #{itemPerPage} OFFSET #{offset}\");\n            body.Add(MakeLevel(1) + \"</select>\");\n        }\n        \n        public void MakeInsertMultipleByKey(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<insert id=\\\"insertMultiple\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"\\\">\");\n            body.Add(MakeLevel(2) + \"INSERT INTO\");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper() + \" (\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeLevel(3) + column.colID.ToUpper() + \",\");\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \") VALUES\");\n            body.Add(MakeLevel(2) + \"<foreach collection=\\\"list\\\" separator=\\\",\\\" item=\\\"entity\\\" open=\\\"(\\\" close=\\\")\\\">\");\n            foreach (Column column in table.columnList)\n            {\n                if (column.colID.ToUpper() == param.GetOne(\"UpdateTimeId\").ToUpper() || column.colID.ToUpper() == param.GetOne(\"CreateTimeId\").ToUpper())\n                {\n                    body.Add(MakeLevel(3) + GetNowTimestampStr(param) + \",\");\n                }\n                else\n                {\n                    body.Add(MakeLevel(3) + \"#{entity.\" + UnderScoreCaseToCamelCase(column.colID) + \"},\");\n                }\n            }\n            body[body.Count - 1] = body[body.Count - 1].Remove(body[body.Count - 1].Length - 1);\n            body.Add(MakeLevel(2) + \"</foreach>\");\n            body.Add(MakeLevel(1) + \"</insert>\");\n        }\n        \n        public void MakeDeleteMultipleByKey(List<string> body, Param param, Table table, Dictionary<string, string> convertDic)\n        {\n            body.Add(MakeLevel(1) + \"<delete id=\\\"deleteMultiple\" + UnderScoreCaseToCamelCase(table.tableID, true) + \"\\\">\");\n            body.Add(MakeLevel(2) + \"DELETE FROM\");\n            body.Add(MakeLevel(2) + table.tableID.ToUpper());\n            body.Add(MakeLevel(2) + \"WHERE\");\n            body.Add(MakeLevel(2) + \"<foreach collection=\\\"list\\\" separator=\\\"or\\\" item=\\\"entity\\\" open=\\\"(\\\" close=\\\")\\\">\");\n            body.Add(MakeLevel(3) + \"1 = 1\");\n            foreach (Column column in table.columnList)\n            {\n                body.Add(MakeTestHead(param, convertDic, column, 3));\n                body.Add(MakeLeftEqualRight(column, 4, \"AND \"));\n                body.Add(MakeLevel(3) + \"</if>\");\n            }\n            body.Add(MakeLevel(2) + \"</foreach>\");\n            body.Add(MakeLevel(1) + \"</delete>\");\n        }\n    }\n}","paramDic":{"EntityPackage":{"describe":"Entity包名","possibleValues":null,"type":2},"MapperPackage":{"describe":"Mapper包名","possibleValues":null,"type":2},"DesignBookType":{"describe":"设计书类型","possibleValues":[{"value":"Postgresql","describe":null},{"value":"SqlServer","describe":null},{"value":"MySQL","describe":null},{"value":"Oracle","describe":null}],"type":1},"DatabaseType":{"describe":"数据库类型","possibleValues":[{"value":"Postgresql","describe":null},{"value":"SqlServer","describe":null},{"value":"MySQL","describe":null},{"value":"Oracle","describe":null}],"type":1},"TableIDPos":{"describe":"表物理名坐标","possibleValues":null,"type":2},"TableNamePos":{"describe":"表逻辑名坐标, 可空","possibleValues":null,"type":2},"StartRowNum":{"describe":"起始行数","possibleValues":null,"type":2},"ColIDCol":{"describe":"列物理名起始列","possibleValues":null,"type":2},"ColNameCol":{"describe":"列逻辑名起始列 可空","possibleValues":null,"type":2},"PrimaryKeyCol":{"describe":"主键, 可空","possibleValues":null,"type":2},"TypeCol":{"describe":"类型起始列","possibleValues":null,"type":2},"DigitsCheckCol":{"describe":"位数起始列, 可空","possibleValues":null,"type":2},"DecimalCheckCol":{"describe":"小数起始列, 可空","possibleValues":null,"type":2},"NullCheckCol":{"describe":"非空制约起始列, 可空","possibleValues":null,"type":2},"EnableValidate":{"describe":"验证注解","possibleValues":[{"value":"Yes","describe":"启用"}],"type":2},"CreateTimeId":{"describe":"创建时间列物理名, 可空","possibleValues":null,"type":2},"UpdateTimeId":{"describe":"修改时间列物理名, 可空","possibleValues":null,"type":2},"DeletedFlagId":{"describe":"逻辑删除判断列物理名, 可空","possibleValues":null,"type":2}}}